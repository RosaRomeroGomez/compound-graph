!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("d3")):"function"==typeof define&&define.amd?define(["exports","lodash","d3"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).myLibrary={},e._,e.d3)}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(t);function a(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){a(i,r,o,s,l,"next",e)}function l(e){a(i,r,o,s,l,"throw",e)}s(void 0)}))}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function v(e,t,n){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function m(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b={createChart:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.attr("width",t+"px"),e.attr("height",n+"px");var o=r.x1||0,a=r.y1||0,i=r.x2||t,s=r.y2||n;return e.attr("preserveAspectRatio","xMinYMin meet"),e.attr("viewBox","".concat(o," ").concat(a," ").concat(i," ").concat(s)),e.append("defs"),e},translate:function(e,t){return"translate(".concat(e,", ").concat(t,")")},line:function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r},pathFn:n.line().x((function(e){return e.x})).y((function(e){return e.y})),MARKER_VIEWBOX:"-5 -5 10 10",ARROW:"M 0,-3.25 L 5 ,0 L 0,3.25",ARROW_SHARP:"M 0,-3 L 5 ,0 L 0,3 L 1 0"},x=["backgroundClick","backgroundDblClick","backgroundMouseEnter","backgroundMouseLeave","backgroundCtx","nodeClick","nodeDblClick","nodeMouseEnter","nodeMouseLeave","nodeCtx","nodeSave","edgeClick","edgeMouseEnter","edgeMouseLeave","edgeCtx"],w=function(){function e(){s(this,e),this.data={},this.registry={}}return c(e,[{key:"setData",value:function(e){this.data=e}},{key:"setCallback",value:function(e,t){if(-1===x.indexOf(e))throw new Error("Failed to register callback, unknown name ".concat(e));this.registry[e]=t}},{key:"unsetCallback",value:function(e){delete this.registry[e]}},{key:"initialize",value:function(e){throw new Error("Needs impl")}},{key:"render",value:function(){throw new Error("Needs impl")}}]),e}(),E=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n(t,r),t.nodes)for(var o=r+1,a=0;a<t.nodes.length;a++)e(t.nodes[a],n,o)},A=function(e){var t=[],n=[];return E(e,(function(e,r){r>0&&(t=t.concat(e)),e.edges&&(n=n.concat(e.edges))})),{nodes:t,edges:n}},O=b.pathFn.curve(n.curveBasis),C=function(e,t){return{x1:e.x1,y1:e.y1,x2:Math.max(e.x2,t.width),y2:Math.max(e.y2,t.height)}},M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(w,e);var t,r,a,l,u,d,g,k,x=y(w);function w(e){var t;if(s(this,w),(t=x.call(this)).options=e||{},t.options.renderMode=t.options.renderMode||"basic",t.options.useEdgeControl=t.options.useEdgeControl||!1,t.options.edgeControlOffsetType=t.options.edgeControlOffsetType||"percentage",t.options.edgeControlOffset=t.options.edgeControlOffset||.66,t.options.useDebugger=t.options.useDebugger||!1,t.adapter=t.options.adapter,t.parentEl=null,t.svgEl=null,t.chart=null,t.chartSize={width:1,height:1},t.layout=null,!e.el)throw new Error("options must provide an element for graph rendering");return t.initialize(e.el),t.zoom=null,t.collapseTracker={},t.hiddenEdges={},t}return c(w,[{key:"initialize",value:function(e){this.parentEl=e,this.chartSize.width=this.parentEl.clientWidth,this.chartSize.height=this.parentEl.clientHeight,this.svgEl=document.createElementNS("http://www.w3.org/2000/svg","svg"),function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}(this.parentEl).appendChild(this.svgEl),this.svgEl.style.userSelect="none"}},{key:"setData",value:function(e){v(f(w.prototype),"setData",this).call(this,e),this.layout=null}},{key:"render",value:(k=i(regeneratorRuntime.mark((function e(){var t,r,o,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.options,this.layout){e.next=5;break}return e.next=4,this.runLayout();case 4:this.layout=e.sent;case 5:this.chart?(r=this.layout.width,o=this.layout.height,a=C({x1:0,y1:0,x2:r,y2:o},this.chartSize),n.select(this.svgEl).attr("viewBox","".concat(a.x1," ").concat(a.y1," ").concat(a.x2," ").concat(a.y2)),n.select(this.svgEl).transition().call(this.zoom.transform,n.zoomIdentity),i=Math.max(2,Math.floor(this.layout.width/this.chartSize.width)),this.zoom.scaleExtent([.5,i])):this.chart=this._createChart(),this.buildDefs(),"basic"===t.renderMode?(this.renderNodes(),this.renderEdges()):(this.renderNodesDelta(),this.renderEdgesDelta()),t.useEdgeControl&&this.renderEdgeControls(),this._enableDrag(),t.useDebugger&&this.renderDebug(),this._enableInteraction();case 12:case"end":return e.stop()}}),e,this)}))),function(){return k.apply(this,arguments)})},{key:"buildDefs",value:function(){var e=n.select(this.svgEl),t=A(this.layout).edges;e.select("defs").selectAll(".edge-marker-end").remove(),e.select("defs").selectAll(".edge-marker-end").data(t).enter().append("marker").classed("edge-marker-end",!0).attr("id",(function(e){var t=e.data.source.replace(/\s/g,""),n=e.data.target.replace(/\s/g,"");return"arrowhead-".concat(t,"-").concat(n)})).attr("viewBox",b.MARKER_VIEWBOX).attr("refX",2).attr("refY",0).attr("orient","auto").attr("markerWidth",15).attr("markerHeight",15).attr("markerUnits","userSpaceOnUse").attr("xoverflow","visible").append("svg:path").attr("d",b.ARROW).style("fill","#000").style("stroke","none")}},{key:"renderEdgesDelta",value:function(){var e=this.chart,t=[];E(this.layout,(function(e){e.edges&&e.edges.length>0&&(t=t.concat(e.edges))}));var r=e.selectAll(".edge").data(t,(function(e){return e.id})),o=r.enter().append("g").classed("edge",!0);r.exit().each((function(e){return e.state="removed"})),o.each((function(e){return e.state="new"})),r.each((function(e){return e.state="updated"})),e.selectAll(".edge").filter((function(e){return"updated"===e.state})).each((function(e){n.select(this).selectAll(".edge-path").datum(e)})),e.selectAll(".edge").filter((function(e){return"new"===e.state})).call(this.renderEdgeAdded),e.selectAll(".edge").filter((function(e){return"updated"===e.state})).call(this.renderEdgeUpdated),e.selectAll(".edge").filter((function(e){return"removed"===e.state})).call(this.renderEdgeRemoved)}},{key:"renderEdges",value:function(){var e=this.chart;e.selectAll(".edge").remove();!function t(n){n.nodes&&n.nodes.forEach((function(e){t(e)})),n.edges&&e.selectAll(".edge").data(n.edges,(function(e){return e.id})).enter().append("g").classed("edge",!0)}(this.layout),e.selectAll(".edge").call(this.renderEdge)}},{key:"renderNodesDelta",value:function(){var e=this.chart;!function e(t,r){if(r){var o=t.selectAll(".node").filter((function(){return this.parentNode===t.node()})).data(r,(function(e){return e.id})),a=o.enter().append("g").classed("node",!0);o.exit().each((function(e){return e.state="removed"})),a.each((function(e){return e.state="new"})),o.each((function(e){return e.state="updated"})),[a,o].forEach((function(t){t.each((function(t){var r=n.select(this);0===r.select(".node-ui").size()&&r.append("g").classed("node-ui",!0),r.select(".node-ui").datum(t),0===r.select(".node-children").size()&&r.append("g").classed("node-children",!0),e(r.select(".node-children"),t.nodes)})),t.transition().duration(1e3).attr("transform",(function(e){return b.translate(e.x,e.y)}))}))}}(e,this.layout.nodes),e.selectAll(".node-ui").filter((function(e){return"new"===e.state})).call(this.renderNodeAdded),e.selectAll(".node-ui").filter((function(e){return"updated"===e.state})).call(this.renderNodeUpdated),e.selectAll(".node-ui").filter((function(e){return"removed"===e.state})).call(this.renderNodeRemoved)}},{key:"renderNodes",value:function(){var e=this.chart;e.selectAll(".node").remove();!function e(t,r){r&&t.selectAll(".node").data(r).enter().append("g").classed("node",!0).attr("transform",(function(e){return b.translate(e.x,e.y)})).each((function(t){var r=n.select(this);r.append("g").classed("node-ui",!0),e(r.append("g"),t.nodes)}))}(e,this.layout.nodes),e.selectAll(".node-ui").call(this.renderNode)}},{key:"calculateEdgeControlPlacement",value:function(e){var t=this.options,n=0,r=e.getTotalLength(),o=t.edgeControlOffset;return n="percentage"===t.edgeControlOffsetType?o*r:o>0?o:Math.max(0,r+o),e.getPointAtLength(n)}},{key:"renderEdgeControls",value:function(){var e=this.chart,t=e.selectAll(".edge");t.selectAll(".edge-control").remove();var r=this;t.each((function(){var e=n.select(this).select("path").node(),t=r.calculateEdgeControlPlacement(e);n.select(this).append("g").classed("edge-control",!0).attr("transform",b.translate(t.x,t.y))})),e.selectAll(".edge-control").call(this.renderEdgeControl)}},{key:"renderDebug",value:function(){var e=this.chart,t=this.options,r=this.chartSize,o=n.select(this.svgEl).select(".background-layer"),a=.5*(this.layout.width<r.width?r.width:this.layout.width),i=.5*(this.layout.height<r.height?r.height:this.layout.height),s=[[-5e3,i,5e3,i],[a,-5e3,a,5e3]];o.selectAll(".info").remove();var l=o.append("g").classed("info",!0),c=n.zoomTransform(e.node());l.append("text").text("TS: "+c.k.toFixed(2)),l.append("text").text("TX: "+c.x.toFixed(2)),l.append("text").text("TY: "+c.y.toFixed(2)),l.append("text").text("Mode: "+t.renderMode),l.selectAll("text").attr("x",3).attr("y",(function(e,t){return 14*(t+1)})).style("font-size","10px"),o.selectAll(".grid").remove(),o.selectAll(".grid").data(s).enter().append("path").classed("grid",!0).attr("d",(function(e){return b.line.apply(b,m(e))})).style("fill","none").style("stroke","#00F").style("stroke-width",1.5).style("opacity",.5)}},{key:"runLayout",value:(g=i(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.adapter.makeRenderingGraph(this.data),n=this.adapter.run(t),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"highlight",value:function(e,t){var r=e.nodes,a=e.edges,i=n.select(this.svgEl),s=this.chart,l=t.color||"red",c=t.duration||2e3,u="glow".concat((new Date).getTime()),d=i.select("defs").append("filter").attr("id",u).attr("width","200%").attr("filterUnits","userSpaceOnUse");d.append("feGaussianBlur").attr("stdDeviation",4.5).attr("result","blur"),d.append("feOffset").attr("in","blur").attr("result","offsetBlur").attr("dx",0).attr("dy",0).attr("x",-10).attr("y",-10),d.append("feFlood").attr("in","offsetBlur").attr("flood-color",l).attr("flood-opacity",.95).attr("result","offsetColor"),d.append("feComposite").attr("in","offsetColor").attr("in2","offsetBlur").attr("operator","in").attr("result","offsetBlur");var h=d.append("feMerge");h.append("feMergeNode").attr("in","offsetBlur"),h.append("feMergeNode").attr("in","SourceGraphic");var f=s.selectAll(".node").filter((function(e){return r.includes(e.id)}));f.style("filter","url(#".concat(u,")")).classed("".concat(u),!0);var p=s.selectAll(".edge").filter((function(e){return o.default.some(a,(function(t){return t.source===e.data.source&&t.target===e.data.target}))}));return p.style("filter","url(#".concat(u,")")).classed("".concat(u),!0),i.select("#".concat(u)).select("feGaussianBlur").transition().duration(c).attr("stdDeviation",0).on("end",(function(){f.style("filter",null),p.style("filter",null)})),u}},{key:"unHighlight",value:function(e){var t=n.select(this.svgEl);t.select("#".concat(e)).remove(),t.selectAll(".".concat(e)).style("filter",null)}},{key:"moveTo",value:function(e,t){var r=this.chart,a=this.chartSize,i=n.select(this.svgEl),s=this.layout.width<a.width?a.width:this.layout.width,l=this.layout.height<a.height?a.height:this.layout.height,c=n.zoomTransform(r.node()),u=A(this.layout).nodes.find((function(t){return t.id===e}));if(!o.default.isNil(u)){for(var d=u.x,h=u.y,f=u;f.parent&&0!==f.parent.depth;)d+=(f=f.parent).x,h+=f.y,console.log(d,h);var p=d+.5*u.width,g=h+.5*u.height;i.transition().duration(t).call(this.zoom.transform,n.zoomIdentity.translate(0,0).scale(c.k).translate(-p+.5*s/c.k,-g+.5*l/c.k))}}},{key:"collapse",value:(d=i(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.chart.selectAll(".node").filter((function(e){return e.id===t})),r=n.selectAll(".node").data().map((function(e){return e.id})),a=this.collapseTracker,i=this.hiddenEdges,a[t]={},a[t].edgeMap={},0!==r.length){e.next=8;break}return e.abrupt("return");case 8:return E(this.layout,(function(e){if(e.id===t&&(e.width=40,e.height=40,a[t].nodes=e.nodes,e.nodes=[],e.collapsed=!0),e.edges){var n=o.default.remove(e.edges,(function(e){return r.includes(e.source)&&r.includes(e.target)}));o.default.isEmpty(n)||(i[e.id]=n);for(var s=0;s<e.edges.length;s++){var l=e.edges[s],c=l.source,u=l.target,d={};r.includes(c)&&(d.source=l.source,l.source=t),r.includes(u)&&(d.target=l.target,l.target=t),o.default.isEmpty(d)||(a[t].edgeMap[l.id]=d)}}})),e.next=11,this.adapter.run(this.layout);case 11:this.layout=e.sent,this.render();case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"expand",value:(u=i(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.chart.selectAll(".node").filter((function(e){return e.id===t})),r=this.collapseTracker,o=this.hiddenEdges,a=r[t],n.datum().nodes=a.nodes,n.datum().collapsed=!1,E(n.datum(),(function(e){({}).hasOwnProperty.call(o,e.id)&&!1===e.collapsed&&(e.edges=e.edges.concat(o[e.id]),delete o[e.id])})),E(this.layout,(function(e){if(e.edges)for(var t=0;t<e.edges.length;t++){var n=e.edges[t];a.edgeMap[n.id]&&(n.target=a.edgeMap[n.id].target||n.target,n.source=a.edgeMap[n.id].source||n.source)}})),delete r[t],e.next=11,this.adapter.run(this.layout);case 11:this.layout=e.sent,this.render();case 13:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"focus",value:(l=i(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1===(n=this.chart.selectAll(".node").filter((function(e){return!0===e.focused}))).size()&&(delete(r=n.datum()).width,delete r.height,delete r.focused),!((o=this.chart.selectAll(".node").filter((function(e){return e.id===t}))).nodes&&o.nodes.length>0)){e.next=5;break}return e.abrupt("return");case 5:return o.datum().width=400,o.datum().height=300,o.datum().focused=!0,e.next=10,this.adapter.run(this.layout);case 10:this.layout=e.sent,this.render();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"unfocus",value:(a=i(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.chart.selectAll(".node").filter((function(e){return e.id===t})),delete(r=n.datum()).width,delete r.height,delete r.focused,e.next=7,this.adapter.run(this.layout);case 7:this.layout=e.sent,this.render();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"group",value:(r=i(regeneratorRuntime.mark((function e(t,n){var r,a,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.chart,a=r.selectAll(".node").filter((function(e){return n.includes(e.id)})).data(),1===o.default.uniq(a.map((function(e){return e.parent.id}))).length){e.next=5;break}return console.log("Cannot group across different levels"),e.abrupt("return");case 5:return i={id:t,label:t,concept:t,depth:a[0].depth,type:"custom",parent:a[0].parent,nodes:[],data:{label:t}},s=a[0].parent,n.forEach((function(e){var t=h({},o.default.remove(s.nodes,(function(t){return t.id===e}))[0]);t.parent=i,i.nodes.push(t)})),s.nodes.push(i),e.next=11,this.adapter.run(this.layout);case 11:this.layout=e.sent,this.render();case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"ungroup",value:(t=i(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.chart,r=n.selectAll(".node").filter((function(e){return e.id===t})).data()[0],a=r.parent,o.default.remove(a.nodes,(function(e){return e.id===t})),r.nodes.forEach((function(e){var t=h({},e);t.parent=a,a.nodes.push(t)})),delete r.nodes,e.next=8,this.adapter.run(this.layout);case 8:this.layout=e.sent,this.render();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"boundary",value:function(){var e=this.chart,t=n.zoomTransform(e.node());return{x1:(0-t.x)/t.k,y1:(0-t.y)/t.k,x2:(this.layout.width-t.x)/t.k,y2:(this.layout.height-t.y)/t.k}}},{key:"cullEdges",value:function(){var e=this.boundary(),t=e.x1,r=e.y1,a=e.x2,i=e.y2;this.chart.selectAll(".edge").each((function(e){var s=o.default.first(e.points),l=o.default.last(e.points);(s.x<t||s.x>a||s.y<r||s.y>i)&&(l.x<t||l.x>a||l.y<r||l.y>i)&&n.select(this).style("opacity",0)}))}},{key:"uncullEdges",value:function(){n.selectAll(".edge").style("opacity",1)}},{key:"_createChart",value:function(){var e=this.chartSize,t=e.width,r=e.height,o={x1:0,y1:0,x2:this.layout.width,y2:this.layout.height},a=n.select(this.svgEl);a.selectAll("*").remove();var i=b.createChart(a,t,r,C(o,this.chartSize));i.attr("preserveAspectRatio","xMidYMid meet"),i.append("g").classed("background-layer",!0);var s=i.append("g").classed("data-layer",!0);i.append("g").classed("foreground-layer",!0);var l=this;var c=Math.max(2,Math.floor(this.layout.width/this.chartSize.width));return this.zoom=n.zoom().scaleExtent([.5,c]).on("zoom",(function(){s.attr("transform",n.event.transform),l.options.useDebugger&&l.renderDebug()})),a.call(this.zoom).on("dblclick.zoom",null),s}},{key:"_enableInteraction",value:function(){var e=this.chart,t=this,r=this.registry,o=n.select(this.svgEl),a=e.selectAll(".node"),i=e.selectAll(".edge");t.clickTimer=null;var s=function(e){return{}.hasOwnProperty.call(r,e)};o.on("click",(function(){n.event.stopPropagation();var e=n.zoomTransform(o.node()).invert(n.mouse(this));s("backgroundClick")&&r.backgroundClick(n.select(this),t,{x:e[0],y:e[1]})})),o.on("dblclick",(function(){n.event.stopPropagation();var e=n.zoomTransform(o.node()).invert(n.mouse(this));s("backgroundDblClick")&&r.backgroundDblClick(n.select(this),t,{x:e[0],y:e[1]})})),a.on("dblclick",(function(){n.event.stopPropagation(),s("nodeDblClick")&&(window.clearTimeout(t.clickTimer),r.nodeDblClick(n.select(this),t))})),a.on("click",(function(){if(n.event.stopPropagation(),s("nodeClick")){var e=this;window.clearTimeout(t.clickTimer),t.clickTimer=window.setTimeout((function(){r.nodeClick(n.select(e),t)}),200)}})),a.on("mouseenter",(function(){n.event.stopPropagation(),s("nodeMouseEnter")&&r.nodeMouseEnter(n.select(this),t)})),a.on("mouseleave",(function(){n.event.stopPropagation(),s("nodeMouseLeave")&&r.nodeMouseLeave(n.select(this),t)})),i.on("click",(function(){n.event.stopPropagation(),s("edgeClick")&&r.edgeClick(n.select(this),t)})),i.on("mouseenter",(function(){n.event.stopPropagation(),s("edgeMouseEnter")&&r.edgeMouseEnter(n.select(this),t)})),i.on("mouseleave",(function(){n.event.stopPropagation(),s("edgeMouseLeave")&&r.edgeMouseLeave(n.select(this),t)}))}},{key:"_enableDrag",value:function(){var e=this.chart,t=this.options,r=A(this.layout),o=e.selectAll(".node"),a=this;var i=n.drag().on("start",(function(){n.event.sourceEvent.stopPropagation()})).on("end",(function(){})).on("drag",(function(){var o=n.select(this),i=[o.datum().id].concat(m(o.selectAll(".node").data().map((function(e){return e.id})))),s=n.select(this.parentNode).datum(),l=n.event.dx,c=n.event.dy;if(s){if(o.datum().x+o.datum().width+l>s.width||o.datum().x+l<0)return;if(o.datum().y+o.datum().height+c>s.height||o.datum().y+c<0)return}o.datum().x+=l,o.datum().y+=c,o.attr("transform",b.translate(o.datum().x,o.datum().y)),r.edges.forEach((function(e){var t=e.source,n=e.target;i.includes(t)&&i.includes(n)?e.points.forEach((function(e){e.x+=l,e.y+=c})):i.includes(t)?(e.points[0].x+=l,e.points[0].y+=c):i.includes(n)&&(e.points[e.points.length-1].x+=l,e.points[e.points.length-1].y+=c)})),e.selectAll(".edge").selectAll("path").attr("d",(function(e){return O(e.points)})),t.useEdgeControl&&e.selectAll(".edge").each((function(){var e=n.select(this).select("path").node(),t=a.calculateEdgeControlPlacement(e);n.select(this).select(".edge-control").attr("transform",b.translate(t.x,t.y))}))}));o.call(i)}},{key:"_trace",value:function(e){var t={},n=this.layout||{edges:[]},r=[];return function e(o){({}).hasOwnProperty.call(t,o)||(t[o]=1,n.edges.filter((function(e){return e.data.target===o})).forEach((function(t){r.push(t),e(t.data.source)})))}(e),{edges:r.map((function(e){return{source:e.data.source,target:e.data.target}})),nodes:o.default.uniq([].concat(m(r.map((function(e){return e.data.source}))),m(r.map((function(e){return e.data.target})))))}}}]),w}(w);e.SVGRenderer=M}));
//# sourceMappingURL=compound-graph.min.js.map
